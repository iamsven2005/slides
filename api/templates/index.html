<!DOCTYPE html><html><head><title>Modern Trello Board</title><style>body {font-family: sans-serif;padding: 2rem;margin: 0;box-sizing: border-box;}#todoArea {display: none;}#board {display: flex;flex-wrap: wrap;gap: 1rem;margin-top: 1rem;justify-content: center;}.column {background: #f0f0f0;padding: 1rem;border-radius: 5px;width: 100%;max-width: 280px;box-sizing: border-box;display: flex;flex-direction: column;}.column h4 {margin-top: 0;display: flex;justify-content: space-between;align-items: center;flex-wrap: wrap;}.task-list {list-style: none;padding: 0;margin: 0;}li {background: #fff;margin-bottom: 0.5rem;padding: 0.5rem;border-radius: 4px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);display: flex;justify-content: space-between;align-items: center;flex-wrap: wrap;}.task-controls {display: flex;flex-wrap: wrap;gap: 4px;}input,button {padding: 6px 12px;margin: 4px 2px;border-radius: 20px;font-size: 14px;border: 1px solid #ccc;}input[type="text"] {flex-grow: 1;max-width: 100%;min-width: 0;}.controls-section {display: flex;flex-wrap: wrap;gap: 0.5rem;margin-bottom: 1rem;justify-content: center;}#loginArea {display: flex;flex-direction: column;align-items: center;justify-content: center;min-height: 80vh;padding: 1rem;}.logout-section {display: flex;justify-content: center;margin-top: 1rem;}#toast {position: fixed;bottom: 20px;right: 20px;background: #333;color: #fff;padding: 10px 16px;border-radius: 8px;box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);display: none;z-index: 999;font-size: 14px;}@media (max-width: 600px) {.column {max-width: 100%;}input,button {font-size: 13px;padding: 6px 10px;}.controls-section {flex-direction: column;align-items: stretch;}.task-controls {justify-content: flex-end;}}</style></head><body><div id="toast" style="position: fixed;bottom: 20px;right: 20px;background: #333;color: #fff;padding: 10px 16px;border-radius: 8px;box-shadow: 0 2px 6px rgba(0,0,0,0.3);display: none;z-index: 999;font-size: 14px;"></div><div id="loginArea"><h3>Welcome Back</h3><input id="username" placeholder="Enter your username"><button onclick="login()">Sign In</button></div><div id="todoArea"><h3>Your Project Board</h3><div><input id="taskInput" placeholder="Add a new task..."><button onclick="addTask()">Add Task</button><input id="searchInput" placeholder="Search tasks..." oninput="filterTasks()"><input id="columnNameInput" placeholder="New column name..."><button class="add-column-btn" onclick="addColumn()">➕ Add Column</button></div><div id="searchResults"></div><div id="board"></div><div class="logout-section"><button onclick="logout()">Sign Out</button></div></div><script>let allTasks = [];let currentColumnId = null;async function login() {const username = document.getElementById('username').value;await fetch('/login', {method: 'POST',headers: { 'Content-Type': 'application/json' },body: JSON.stringify({ username })});showToast('Logged in successfully');document.getElementById('loginArea').style.display = 'none';document.getElementById('todoArea').style.display = 'block';loadBoard();}async function logout() {await fetch('/logout');showToast('Logged out');document.getElementById('loginArea').style.display = 'flex';document.getElementById('todoArea').style.display = 'none';allTasks = [];}async function addTask() {const task = document.getElementById('taskInput').value;if (!task.trim()) return;await fetch('/add', {method: 'POST',headers: { 'Content-Type': 'application/json' },body: JSON.stringify({ task })});showToast('Added');document.getElementById('taskInput').value = '';loadBoard();}async function deleteTask(id) {await fetch(`/delete/${id}`, { method: 'DELETE' });showToast('Deleted');loadBoard();}async function editTask(id, newTask) {await fetch(`/edit/${id}`, {method: 'PUT',headers: { 'Content-Type': 'application/json' },body: JSON.stringify({ task: newTask })});showToast('Task edited');loadBoard();}async function moveTask(taskId, toColumnId, newPosition) {await fetch('/move', {method: 'POST',headers: { 'Content-Type': 'application/json' },body: JSON.stringify({task_id: taskId,to_column_id: toColumnId,new_position: newPosition})});showToast('Shifted Task');loadBoard();}async function addColumn() {const name = document.getElementById('columnNameInput').value;if (!name.trim()) return;await fetch('/column', {method: 'POST',headers: { 'Content-Type': 'application/json' },body: JSON.stringify({ name })});showToast('Added Column');document.getElementById('columnNameInput').value = '';loadBoard();}async function deleteColumn(id) {await fetch(`/column/${id}`, { method: 'DELETE' });loadBoard();}async function loadBoard() {const res = await fetch('/board');const board = await res.json();const boardDiv = document.getElementById('board');boardDiv.innerHTML = '';board.forEach(col => {const colDiv = document.createElement('div');colDiv.className = 'column';colDiv.dataset.columnId = col.id;const nameSpan = document.createElement('span');nameSpan.textContent = col.name;const nameInput = document.createElement('input');nameInput.type = 'text';nameInput.value = col.name;nameInput.style.display = 'none';const saveBtn = document.createElement('button');saveBtn.textContent = '💾';saveBtn.style.display = 'none';saveBtn.onclick = () => {renameColumn(col.id, nameInput.value);};const editBtn = document.createElement('button');editBtn.textContent = '✏️';editBtn.onclick = () => {nameSpan.style.display = 'none';nameInput.style.display = 'inline';saveBtn.style.display = 'inline';editBtn.style.display = 'none';};const duplicateBtn = document.createElement('button');duplicateBtn.textContent = '📄';duplicateBtn.onclick = () => duplicateColumn(col.id);const deleteBtn = document.createElement('button');deleteBtn.textContent = '🗑️';deleteBtn.onclick = () => deleteColumn(col.id);const title = document.createElement('h4');title.appendChild(nameSpan);title.appendChild(nameInput);title.appendChild(saveBtn);title.appendChild(editBtn);title.appendChild(duplicateBtn);title.appendChild(deleteBtn);colDiv.appendChild(title);const ul = document.createElement('ul');ul.className = 'task-list';ul.dataset.columnId = col.id;col.tasks.forEach(task => {const li = document.createElement('li');const span = document.createElement('span');span.textContent = task.task;span.style.flexGrow = '1';const input = document.createElement('input');input.type = 'text';input.value = task.task;input.style.display = 'none';const saveBtn = document.createElement('button');saveBtn.textContent = '💾';saveBtn.style.display = 'none';saveBtn.onclick = () => {editTask(task.id, input.value);};const editBtn = document.createElement('button');editBtn.textContent = '✏️';editBtn.onclick = () => {span.style.display = 'none';input.style.display = 'inline';saveBtn.style.display = 'inline';editBtn.style.display = 'none';};const deleteBtn = document.createElement('button');deleteBtn.textContent = '🗑️';deleteBtn.onclick = () => {deleteTask(task.id);};const controlDiv = document.createElement('div');controlDiv.className = 'task-controls';controlDiv.appendChild(input);controlDiv.appendChild(saveBtn);controlDiv.appendChild(editBtn);controlDiv.appendChild(deleteBtn);const leftBtn = document.createElement('button');leftBtn.textContent = '⬅️';leftBtn.onclick = () => moveTaskLeft(task.id, col.id);const rightBtn = document.createElement('button');rightBtn.textContent = '➡️';rightBtn.onclick = () => moveTaskRight(task.id, col.id);controlDiv.appendChild(leftBtn);controlDiv.appendChild(rightBtn);li.appendChild(span);li.appendChild(controlDiv);ul.appendChild(li);});colDiv.appendChild(ul);boardDiv.appendChild(colDiv);});}function getColumnIndex(columns, columnId) {return columns.findIndex(col => col.id === columnId);}async function moveTaskLeft(taskId, currentColumnId) {const res = await fetch('/board');const board = await res.json();const index = getColumnIndex(board, currentColumnId);if (index > 0) {const newColumn = board[index - 1];await moveTask(taskId, newColumn.id, 999);}}async function moveTaskRight(taskId, currentColumnId) {const res = await fetch('/board');const board = await res.json();const index = getColumnIndex(board, currentColumnId);if (index < board.length - 1) {const newColumn = board[index + 1];await moveTask(taskId, newColumn.id, 999);}}function filterTasks() {const query = document.getElementById('searchInput').value.toLowerCase();const boardDiv = document.getElementById('board');const resultsDiv = document.getElementById('searchResults');if (query.trim() === '') {resultsDiv.innerHTML = '';boardDiv.style.display = 'flex';return;}boardDiv.style.display = 'none';resultsDiv.innerHTML = `<h4>Search Results for "${query}"</h4>`;const columns = document.querySelectorAll('.column');let found = 0;columns.forEach(col => {const colName = col.querySelector('h4 span').textContent;const tasks = col.querySelectorAll('.task-list li');tasks.forEach(taskEl => {const taskText = taskEl.querySelector('span').textContent;if (taskText.toLowerCase().includes(query)) {const result = document.createElement('div');result.textContent = `📌 ${taskText} (in "${colName}")`;resultsDiv.appendChild(result);found++;}});});if (found === 0) {resultsDiv.innerHTML += `<p>No matching tasks found.</p>`;}}const eventSource = new EventSource("/events");eventSource.onmessage = function (event) {loadBoard();};async function duplicateColumn(id) {await fetch(`/column/${id}/duplicate`, {method: 'POST'});loadBoard();}async function renameColumn(id, newName) {if (!newName.trim()) return;await fetch(`/column/${id}`, {method: 'PUT',headers: { 'Content-Type': 'application/json' },body: JSON.stringify({ name: newName })});loadBoard();}function showToast(message) {const toast = document.getElementById('toast');toast.textContent = message;toast.style.display = 'block';setTimeout(() => {toast.style.display = 'none';}, 2500);}</script></body></html>